@use 'sass:math'

@font-face
  font-family: Stardew Valley Stonks
  src: url("/public/Stardew Valley Stonks.otf")

@function ui-img($file)
  @return url("/public/img/UI/#{$file}.png")


$arrow-length: 1em

%arrow
  content: ""
  display: inline-block
  background-size: contain
  background-repeat: no-repeat
  background-position: center center
  width: $arrow-length
  height: $arrow-length

%arrow-left
  background-image: ui-img(Arrow Left)

%arrow-right
  background-image: ui-img(Arrow Right)

%arrow-up
  background-image: ui-img(Arrow Up)

%arrow-down
  background-image: ui-img(Arrow Down)

%season
  height: 1.25em

@each $season in Spring Summer Fall Winter
  .#{to-lower-case($season)}
    @extend %season
    content: url("/public/img/Seasons/#{$season}.png")

.icon
  width: 1.5em
  height: 1.5em

  &-processor
    width: 1.25em

  &-text
    display: inline-block
    width: max-content

    & > :first-child
      vertical-align: text-bottom
      margin-right: 0.375em

@mixin icon-img($name, $folder, $className: $name)
  .#{to-lower-case($className)}
    @extend .icon
    content: url("/public/img/#{$folder}/#{$name}.png")

@each $product in Jam Pickles Wine Juice
  @include icon-img($product, Products)

@each $profession in Tiller Artisan Agriculturist Gatherer Botanist
  @include icon-img($profession, Skills)

%skill
  width: 1.25em
  height: 1.25em

@each $skill in Farming Foraging
  .#{to-lower-case($skill)}
    @extend %skill
    content: url("/public/img/Skills/#{$skill}.png")

@mixin quality($quality, $color)
  .#{to-lower-case(#{$quality})}
    --color: #{$color}
    --img: url("/public/img/Qualities/#{$quality}.png")

@include quality(Iridium, scale-color(mix(#db67c4, #801fe2), $lightness: 25%))
@include quality(Gold, mix(#ffff18, #efc90b))
@include quality(Silver, mix(#dadfe5, #a0a0a0))
@include quality(Normal, white)


%colon
  &::after
    font-weight: 600
    content: ":"

%button-unstyled
  padding: 0
  background: none
  outline: none
  box-shadow: none
  border: none
  color: black

.button
  background: none
  color: black
  image-rendering: pixelated
  $img-scale: 7
  border-image-source: ui-img(Button)
  border-image-slice: ($img-scale * 2) fill
  border-image-width: 0.25em
  padding: 0.625em 0.5em 0.5em 0.5em

  &:hover
    @extend %hover-brightness

$border-box-outset: 0.75rem
%border-box
  image-rendering: pixelated
  $img-scale: 4
  border-image-source: ui-img(Border Box)
  border-image-slice: ($img-scale * 4) fill
  border-image-width: 1rem
  border-image-outset: $border-box-outset
  margin: $border-box-outset

  &-inner
    @extend %border-box
    border-image-outset: 0
    margin: 0
    padding: $border-box-outset

  & > *
    image-rendering: initial

%focus-outline
  outline: var(--border-thin) solid #d83700
  outline-offset: var(--border-thin)

:focus
  @extend %focus-outline

%hover-brightness
  filter: brightness(1.15)

%hover-scale
  transform: scale(1.1)


:root
  font-family: Stardew Valley Stonks, Nunito, sans
  line-height: 1.25
  word-spacing: 0.125em

body
  margin: 0
  display: flex
  flex-direction: column
  align-items: center
  min-width: min-content
  min-height: 100vh
  width: 100%

  image-rendering: pixelated
  background-image: ui-img(Background)
  background-size: cover
  background-position: center bottom
  background-attachment: fixed
  overflow-y: scroll

  & > span // noscript
    @extend %border-box
    display: block
    width: max-content
    font-size: 1.5rem
    margin: 1em auto
    padding: 1em

  & > *
    box-sizing: border-box
    width: 100%
    image-rendering: initial

$header-padding: 1.5em
header
  padding: $header-padding
  max-width: 100vw

  & > a
    display: flex
    flex-wrap: wrap
    justify-content: center
    row-gap: 1em
    column-gap: 2em

footer
  display: flex
  flex-wrap: wrap
  align-items: center
  justify-content: space-evenly
  text-align: center

  gap: 1em
  padding: 1em
  min-height: 15vh

  font-size: 1.25rem

  & > span
    @extend %border-box
    padding: 0.625em 0.75em 0.5em 0.75em


$title-img-max-width: 428
$title-img-height: 84
@media (max-width: calc(2 * $header-padding + $title-img-max-width * 1px))
  header > a > div
    width: 100%
    aspect-ratio: #{$title-img-max-width} / $title-img-height
    display: flex
    justify-content: center


img
  user-select: none

dl
  display: grid
  grid-template-columns: fit-content(13em) auto
  gap: 0.5em
  margin: 0

dt
  @extend %colon
  text-align: right

dd
  margin: 0

details
  & > summary
    list-style: none
    cursor: pointer
    user-select: none
    font-size: 1.5rem
    padding: 0.5em 0.5em 0.25em 0.5em

    &::marker,
    &::-webkit-details-marker
      display: none

    &::before
      @extend %arrow
      @extend %arrow-right
      margin-right: 0.5em

    &:hover::before
      @extend %hover-scale

    &:focus
      outline-offset: calc(-1 * var(--border-thin))

  & > div
    display: flex
    flex-direction: column
    row-gap: 0.5em
    padding: 0.5em

  &[open] > summary::before
    @extend %arrow-down
